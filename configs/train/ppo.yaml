algorithm: ppo

data:
  train_path: data/repliqa/clean/train.jsonl
  eval_path: data/repliqa/clean/eval.jsonl
  documents_path: data/repliqa/clean/documents.jsonl

prompt:
  template: |
    You are a question answering assistant.

    Answer the question ONLY using the provided document.

    If the answer cannot be found in the document, say:
    FINAL: Not found

    Keep the answer concise. Do not provide explanation.

    Format your response exactly as:

    FINAL: <short answer>

    Document:
    {context}

    Question:
    {question}

training:
  output_dir: runs/ppo_baseline
  per_device_train_batch_size: 1
  per_device_eval_batch_size: 1
  gradient_accumulation_steps: 1
  num_train_epochs: 1
  learning_rate: 5e-6
  max_prompt_length: 512
  max_completion_length: 64
  num_mini_batches: 1
  num_ppo_epochs: 4
  temperature: 1.0
  kl_coef: 0.05
  gamma: 1.0
  lam: 0.95
  local_rollout_forward_batch_size: 1
  stop_token: eos
  missing_eos_penalty: 1.0
  report_to: none

reward_model:
  model_name: runs/reward_qwen05b_clean/merged
  freeze: true
  use_lora: false

value_model:
  model_name: runs/reward_qwen05b_clean/merged
  freeze_backbone: false
  use_lora: true

lora:
  r: 16
  alpha: 32
  dropout: 0.05
  target_modules:
    - q_proj
    - v_proj
